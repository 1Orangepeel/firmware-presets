# Title: Karate Race
# FirmwareVersion: 4.3
# Category: TUNE
# Official: true
# Keywords: karate, 6S, race, world champion, 5 inch, 5", sugarK, limon, ctzsnooze, karatreBrot
# Author: Zak Smiley SugarK
# Description: This 6s racing tune was developed with the help of @ctzsnooze around @karatebrotâ€™s RPM crossfade code allowing a pretty aggressive filter array which is the karate array. 
# Description: This tune works well on any quality airframes and has been flown on the Viper racer (where it was developed ) BMS Js1, 533 switchback, HGLRC wind and of course @limons Open racer. 
# Description: It should also work on other quality racing frames but use at your own risk as it is an aggressive tune. This tune so far has won a good number of events including the 2021 IO.
# Description: 
# Description: Things to note.. YOU have to use RPM filtering on this tune, failure to do so might result in fire and regarding Dshot600,  if your setup has errors in the motor tab using bidirectional Dshot then change to 8k/4k and dshot300.
# Description: Also this should be applied to a clean flash after you've setup your rates, swtiches, vtx tables etc. To test arm the quad with props on, it should sound clean with no grinding, if it passes that then hover test and check motor temps.
# Description:  If any thing is off don't fly it!!
# Description: 
# Description: SECOND NOTE.... Radio links.. 1. Make sure your radio system is totally up to date using either Edgetx or Opentx and your ADC in the hardware page is OFF 2. Go to the radio presets and apply the correct setup for your system and link speed.
# Discussion: https://github.com/betaflight/firmware-presets/pull/41

# master
set gyro_lpf2_static_hz = 1000
set gyro_lpf1_type = PT1
set gyro_lpf2_type = PT1
set dyn_notch_count = 2
set dyn_notch_q = 500
set dyn_notch_min_hz = 200
set gyro_lpf1_dyn_min_hz = 500
set gyro_lpf1_dyn_max_hz = 1000
set yaw_spin_recovery = AUTO
set thrust_linear = 0
set dshot_bidir = ON
set motor_pwm_protocol = DSHOT600
set small_angle = 180
set simplified_gyro_filter_multiplier = 200
set debug_mode = GYRO_SCALED
set rpm_filter_harmonics = 3
set rpm_filter_q = 500
set rpm_filter_min_hz = 100
set rpm_filter_fade_range_hz = 100
set rpm_filter_lpf_hz = 150
set name = karate race

profile 0

# profile 0
set dterm_lpf1_dyn_min_hz = 75
set dterm_lpf1_dyn_max_hz = 150
set dterm_lpf1_dyn_expo = 10
set dterm_lpf1_type = PT1
set dterm_lpf1_static_hz = 150
set dterm_lpf2_type = PT1
set dterm_lpf2_static_hz = 150
set dterm_notch_hz = 0
set dterm_notch_cutoff = 0
set anti_gravity_gain = 5500
set p_pitch = 42
set i_pitch = 89
set d_pitch = 41
set f_pitch = 138
set p_roll = 38
set i_roll = 81
set d_roll = 37
set f_roll = 125
set d_min_roll = 22
set d_min_pitch = 24
set feedforward_jitter_reduction = 5
set feedforward_max_rate_limit = 90
set dyn_idle_min_rpm = 40
set dyn_idle_p_gain = 35
set dyn_idle_i_gain = 35
set dyn_idle_d_gain = 35
set simplified_pids_mode = RP
set simplified_i_gain = 120
set simplified_d_gain = 75
set simplified_pi_gain = 85
set simplified_dmax_gain = 200
set simplified_feedforward_gain = 105
set simplified_pitch_d_gain = 110
set simplified_pitch_pi_gain = 110
set simplified_dterm_filter = ON
set simplified_dterm_filter_multiplier = 100



# rateprofile 
set tpa_rate = 70
set tpa_breakpoint = 1250


# option begin (checked) dynamic idle 

#dynamic idle for 6s 2000kv
set dshot_idle_value = 400
set dyn_idle_min_rpm = 40
set dyn_idle_p_gain = 35
# option end


# option begin (unchecked) spicy tune 

#spicy tune use with care

set dyn_notch_count = 1
set dyn_notch_q = 500
set dyn_notch_min_hz = 250
set rpm_filter_harmonics = 2
set p_pitch = 42
set i_pitch = 89
set d_pitch = 42
set f_pitch = 138
set p_roll = 38
set i_roll = 81
set d_roll = 38
set f_roll = 125
set d_min_roll = 27
set d_min_pitch = 29
set feedforward_jitter_reduction = 5
set feedforward_max_rate_limit = 90
set simplified_pids_mode = RP
set simplified_i_gain = 120
set simplified_d_gain = 90
set simplified_pi_gain = 85
set simplified_dmax_gain = 125
set simplified_feedforward_gain = 105
set simplified_pitch_d_gain = 110
set simplified_pitch_pi_gain = 110
# option end

